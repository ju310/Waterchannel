# Bathymetry Reconstruction in a Water Channel

## Description
This code reconstructs the bathymetry in a water channel using either simulated or experimental observation data. We use gradient descent to minimise an objective functional, where we compute the numerical solution of the continuous adjoint problem in order to determine the gradient. The forward problem is modelled by the nonlinear nonrotating shallow water equations and discretised with the spectral methods framework [Dedalus](https://dedalus-project.org/).
## How to reproduce the data and plots
# Solutions of the SWE
- Go to the file ProblemRelatedFiles/Compute_channel_forward.py.
- Set variables as needed. In particular, put the variable "save" to "True".
- Execute the file.
# Plots of the solution of the SWE
- Go to the file "create_plots_forward.py".
- Insert the file name that was generated by "ProblemRelatedFiles/Compute_channel_forward.py".
- Set "save" to "True".
- Execute the file.
# Optimisation results
We provide the hdf5 files with optimisation data here (Link still to be added). If you want to compute those yourself, use the file gradient_descent.py as follows.
- Put the variable "save" to "True".
- In ProblemRelatedFiles/params.py change the indicated variables as needed.
- Execute the file gradient_descent.py.
# Plots of the bathymetry reconstruction etc.
- Go to the file "create_plots.py".
- Insert the folder name that was generated by the file "gradient_descent.py" (e.g. 2024_02_22_09_12_AM).
- Set "save" to "True".
- Execute the file.
# Plot of the bathymetry
- Execute the file "plot_bathymetry.py".
- Optional: Uncomment the code lines at the bottom to save the figure.
-------------
## Requirements
Installation of Dedalus version 3.0.0 is required. See the file "requirements.txt".
------------
## Acknoledgements
The authors acknowledge the support by the Deutsche Forschungsgemeinschaft (DFG) within the Research Training Group GRK 2583 ``Modeling, Simulation and Optimization of Fluid Dynamic Applications''.
